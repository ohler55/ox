# https://www.appveyor.com/docs/lang/ruby/

version: '{branch}-{build}'

image:
  - Ubuntu
  #- macOS
  #- Visual Studio 2019

cache:
  - vendor/bundle

platform:
  - x86

environment:
  matrix:
    - APPVEYOR_BUILD_WORKER_IMAGE: Ubuntu
      RUBY_VERSION: 30
    - APPVEYOR_BUILD_WORKER_IMAGE: Ubuntu
      RUBY_VERSION: 27-x64
    - APPVEYOR_BUILD_WORKER_IMAGE: Ubuntu
      RUBY_VERSION: 26-x64
    - APPVEYOR_BUILD_WORKER_IMAGE: Ubuntu
      RUBY_VERSION: 25-x64
    - APPVEYOR_BUILD_WORKER_IMAGE: Ubuntu
      RUBY_VERSION: 24-x64

build: off

before_build:
  - ps: |
     if ($env:RUBY_VERSION -eq "30")
     {
       rvm get stable
       rvm install ruby-3.0.0
       rvm use ruby-3.0.0
     }

  - which ruby
  - gem update --system
  - ruby -v
  - make -v
  #- bundle -v

build_script:
  - pwd
  - ls
  - cd ext/ox
  - ruby extconf.rb
  - make
  - cd ../../test
  - ruby tests.rb
  - ruby sax/sax_test.rb

matrix:
  fast_finish: true
